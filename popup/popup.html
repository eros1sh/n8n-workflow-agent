<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="extensionName"></title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="popup-container">
    <!-- Header -->
    <div class="header">
      <div class="logo-icon">üí¨</div>
      <h1 class="header-title">
        <span class="n8n-text">n8n</span><span class="chat-text" data-i18n="chat"></span>
      </h1>
      <p class="header-subtitle" data-i18n="configureActivate"></p>
    </div>

    <!-- Activation Card -->
    <div class="card activation-card">
      <p class="activation-text" data-i18n="selfHostingActivate"></p>
      <button id="activate-btn" class="activate-button" data-i18n="activateOnCurrentPage"></button>
      <p class="auto-activate-text" data-i18n="autoActivateHosted">
        <a href="https://n8n.io" target="_blank" class="n8n-link" data-i18n="n8nHostedLink">
          <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M2 2H10V10M10 2L2 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
        </a>
      </p>
    </div>

    <!-- Settings Header -->
    <h2 class="settings-title" data-i18n="settings">Settings</h2>

    <!-- Tabs -->
    <div class="tabs">
      <button class="tab-button active" data-tab="api" data-i18n="api"></button>
      <button class="tab-button" data-tab="chat" data-i18n="chat"></button>
    </div>

    <!-- API Tab -->
    <div class="tab-content" id="api-tab">
      <div class="card">
        <!-- Save Button -->
        <button id="save-api-btn" class="save-button" style="width: 100%; margin-bottom: 16px; padding: 10px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
          <span data-i18n="saveSettings"></span>
        </button>
        <!-- Provider and Model Row -->
        <div class="form-row">
          <div class="form-group">
            <label data-i18n="provider"></label>
            <select id="provider-select" class="form-select">
              <option value="google">Google</option>
              <option value="openai">OpenAI</option>
              <option value="anthropic">Anthropic</option>
              <option value="deepseek">DeepSeek</option>
              <option value="openrouter">OpenRouter</option>
              <option value="groq">Groq</option>
              <option value="huggingface">Hugging Face</option>
            </select>
          </div>
          <div class="form-group">
            <label data-i18n="model">Model</label>
            <div class="model-select-wrapper">
              <select id="model-select" class="form-select">
                <option value="" data-i18n="enterApiKeyFirst"></option>
              </select>
              <input 
                type="text" 
                id="model-custom-input" 
                class="model-custom-input" 
                data-i18n-placeholder="orEnterCustomModelName"
                style="display: none;"
              >
              <button 
                type="button" 
                id="model-toggle-btn" 
                class="model-toggle-btn"
                data-i18n-title="switchBetweenPresetAndCustom"
              >
                <svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M7 1L9 5H5L7 1Z" fill="currentColor"/>
                  <path d="M7 13L5 9H9L7 13Z" fill="currentColor"/>
                  <path d="M1 7L5 5V9L1 7Z" fill="currentColor"/>
                  <path d="M13 7L9 9V5L13 7Z" fill="currentColor"/>
                </svg>
              </button>
            </div>
          </div>
        </div>

        <!-- API Key -->
        <div class="form-group" id="api-key-group">
          <label id="api-key-label" data-i18n="apiKey"></label>
          <input type="password" id="api-key-input" class="form-input" data-i18n-placeholder="enterApiKey">
          <a href="#" id="api-key-link" target="_blank" class="api-key-link" data-i18n="getGoogleKey">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M2 2H10V10M10 2L2 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </a>
        </div>

        <!-- API URL (for Local LLM) -->
        <div class="form-group" id="api-url-group" style="display: none;">
          <label data-i18n="apiUrl"></label>
          <input type="text" id="api-url-input" class="form-input" data-i18n-placeholder="enterApiUrl">
        </div>

        <!-- Google Search Toggle (only for Google provider) -->
        <div class="form-group" id="google-search-group">
          <div class="toggle-row">
            <div>
              <label data-i18n="googleSearch"></label>
              <p class="toggle-description" data-i18n="googleSearchDesc"></p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="google-search-toggle">
              <span class="toggle-slider"></span>
            </label>
          </div>
        </div>

        <!-- Thinking Mode (for reasoning models) -->
        <div class="toggle-item" id="thinking-mode-group" style="display: none;">
          <div class="toggle-content">
            <label data-i18n="thinkingMode"></label>
            <p class="toggle-description" data-i18n="thinkingModeDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="thinking-mode-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <div id="api-message" class="message"></div>
      </div>
    </div>

    <!-- Chat Tab -->
    <div class="tab-content" id="chat-tab" style="display: none;">
      <div class="card">
        <!-- Save Button -->
        <button id="save-chat-btn" class="save-button" style="width: 100%; margin-bottom: 16px; padding: 10px; background: var(--primary); color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 500;">
          <span data-i18n="saveSettings"></span>
        </button>
      </div>

      <!-- Custom System Instructions -->
      <div class="card">
        <h3 class="section-title" data-i18n="customSystemInstructions"></h3>
        <p class="section-description" data-i18n="customSystemInstructionsDesc"></p>
        <textarea 
          id="custom-instructions-input" 
          class="custom-instructions-textarea" 
          data-i18n-placeholder="enterCustomInstructionsPlaceholder"
          rows="4"
        ></textarea>
      </div>

      <!-- Settings Section -->
      <div class="card">
        <h3 class="section-title" data-i18n="settings"></h3>
        
        <!-- Include Workflow Context -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="includeWorkflowContext"></label>
            <p class="toggle-description" data-i18n="includeWorkflowContextDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="include-workflow-context-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Save UI Position -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="saveUIPosition"></label>
            <p class="toggle-description" data-i18n="saveUIPositionDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="save-ui-position-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Message Fade Delay -->
        <div class="form-group">
          <label data-i18n="messageFadeDelay"></label>
          <p class="toggle-description" data-i18n="messageFadeDelayDesc"></p>
          <input type="number" id="message-fade-delay-input" min="0" max="60" value="0" class="form-input" style="margin-top: 8px;">
        </div>
      </div>

      <!-- Tools Section -->
      <div class="card">
        <h3 class="section-title" data-i18n="tools"></h3>
        
        <!-- Workflow Access -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="workflowAccess"></label>
            <p class="toggle-description" data-i18n="workflowAccessDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="workflow-access-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Node Library Access -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="nodeLibraryAccess"></label>
            <p class="toggle-description" data-i18n="nodeLibraryAccessDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="node-library-access-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Node Creation -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="nodeCreation"></label>
            <p class="toggle-description" data-i18n="nodeCreationDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="node-creation-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Node Editing -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="nodeEditing"></label>
            <p class="toggle-description" data-i18n="nodeEditingDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="node-editing-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Node Removal -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="nodeRemoval"></label>
            <p class="toggle-description" data-i18n="nodeRemovalDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="node-removal-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Affiliate Recommendations -->
        <div class="toggle-item">
          <div class="toggle-content">
            <label data-i18n="affiliateRecommendations"></label>
            <p class="toggle-description" data-i18n="affiliateRecommendationsDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="affiliate-recommendations-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

                <!-- Node Cloning -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="nodeCloning"></label>
                    <p class="toggle-description" data-i18n="nodeCloningDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="node-cloning-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Connection Management -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="advancedConnectionManagement">Advanced Connection Management</label>
                    <p class="toggle-description" data-i18n="advancedConnectionManagementDesc">Allows chat to remove, update, and manage node connections</p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="connection-management-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Bulk Operations -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="bulkOperations"></label>
                    <p class="toggle-description" data-i18n="bulkOperationsDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="bulk-operations-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Auto Layout -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="autoLayout"></label>
                    <p class="toggle-description" data-i18n="autoLayoutDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="auto-layout-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Workflow Validation -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="workflowValidation"></label>
                    <p class="toggle-description" data-i18n="workflowValidationDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="workflow-validation-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Workflow Execution -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="workflowExecution"></label>
                    <p class="toggle-description" data-i18n="workflowExecutionDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="workflow-execution-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Advanced Import/Export -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="advancedImportExport"></label>
                    <p class="toggle-description" data-i18n="advancedImportExportDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="advanced-import-export-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Execution History & Analytics -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="executionHistory"></label>
                    <p class="toggle-description" data-i18n="executionHistoryDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="execution-history-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Workflow Templates -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="workflowTemplates"></label>
                    <p class="toggle-description" data-i18n="workflowTemplatesDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="workflow-templates-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Workflow Optimization -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="workflowOptimization"></label>
                    <p class="toggle-description" data-i18n="workflowOptimizationDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="workflow-optimization-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Workflow Versioning -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="workflowVersioning"></label>
                    <p class="toggle-description" data-i18n="workflowVersioningDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="workflow-versioning-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Advanced Debugging -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="advancedDebugging"></label>
                    <p class="toggle-description" data-i18n="advancedDebuggingDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="advanced-debugging-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Testing Framework -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="testingFramework"></label>
                    <p class="toggle-description" data-i18n="testingFrameworkDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="testing-framework-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- CI/CD Integration -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="cicdIntegration"></label>
                    <p class="toggle-description" data-i18n="cicdIntegrationDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="cicd-integration-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Custom Node Development -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="customNodeDevelopment"></label>
                    <p class="toggle-description" data-i18n="customNodeDevelopmentDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="custom-node-development-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>
        
                <!-- Documentation Generation -->
                <div class="toggle-item">
                  <div class="toggle-content">
                    <label data-i18n="documentationGeneration"></label>
                    <p class="toggle-description" data-i18n="documentationGenerationDesc"></p>
                  </div>
                  <label class="toggle-switch">
                    <input type="checkbox" id="documentation-generation-toggle">
                    <span class="toggle-slider"></span>
                  </label>
                </div>

      </div>

      <!-- Debug Mode Section -->
      <div class="card" style="border: 2px solid var(--primary); background: rgba(0, 255, 71, 0.05);">
        <h3 class="section-title" style="color: var(--primary); display: flex; align-items: center; gap: 8px;">
          <span>üêõ</span>
          <span data-i18n="debugMode"></span>
          <span style="font-size: 11px; font-weight: normal; background: var(--primary); color: black; padding: 2px 8px; border-radius: 4px;" data-i18n="debugModeAdvanced"></span>
        </h3>
        
        <!-- Debug Mode Toggle -->
        <div class="toggle-item" style="margin-bottom: 16px;">
          <div class="toggle-content">
            <label style="font-weight: 600;" data-i18n="enableRealTimeDebugApi"></label>
            <p class="toggle-description" data-i18n="enableRealTimeDebugApiDesc"></p>
          </div>
          <label class="toggle-switch">
            <input type="checkbox" id="debug-mode-toggle">
            <span class="toggle-slider"></span>
          </label>
        </div>

        <!-- Debug Options (visible when debug is enabled) -->
        <div id="debug-options" style="display: none; padding: 16px; background: rgba(0, 0, 0, 0.3); border-radius: 8px; margin-top: 12px;">
          
          <!-- Server URL -->
          <div class="form-group" style="margin-bottom: 12px;">
            <label style="font-size: 12px; color: var(--primary);" data-i18n="debugServerUrl">Debug Server URL</label>
            <input 
              type="text" 
              id="debug-server-url-input" 
              class="form-input" 
              value="http://localhost:3333"
              style="margin-top: 4px; font-family: monospace; font-size: 12px;"
            >
          </div>

          <!-- Auto-connect -->
          <div class="toggle-item" style="margin-bottom: 12px;">
            <div class="toggle-content">
              <label style="font-size: 13px;" data-i18n="autoConnectOnStartup"></label>
              <p class="toggle-description" style="font-size: 11px;" data-i18n="autoConnectOnStartupDesc"></p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="debug-auto-connect-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- Console Logging -->
          <div class="toggle-item" style="margin-bottom: 12px;">
            <div class="toggle-content">
              <label style="font-size: 13px;" data-i18n="consoleLogging"></label>
              <p class="toggle-description" style="font-size: 11px;" data-i18n="consoleLoggingDesc"></p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="debug-console-logging-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- PII Masking -->
          <div class="toggle-item" style="margin-bottom: 12px;">
            <div class="toggle-content">
              <label style="font-size: 13px;" data-i18n="piiMasking"></label>
              <p class="toggle-description" style="font-size: 11px;" data-i18n="piiMaskingDesc"></p>
            </div>
            <label class="toggle-switch">
              <input type="checkbox" id="debug-pii-masking-toggle" checked>
              <span class="toggle-slider"></span>
            </label>
          </div>

          <!-- Quick Actions -->
          <div style="margin-top: 16px; padding-top: 12px; border-top: 1px solid rgba(255, 255, 255, 0.1);">
            <p style="font-size: 11px; color: #888; margin-bottom: 8px;" data-i18n="quickActions"></p>
            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
              <button id="open-dashboard-btn" class="quick-action-btn" style="flex: 1; min-width: 120px; padding: 6px 12px; background: var(--primary); color: black; border: none; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: 500;" data-i18n="openDashboard"></button>
              <button id="clear-debug-logs-btn" class="quick-action-btn" style="flex: 1; min-width: 120px; padding: 6px 12px; background: #ff4444; color: white; border: none; border-radius: 4px; font-size: 11px; cursor: pointer; font-weight: 500;" data-i18n="clearLogs"></button>
            </div>
            <button id="test-debug-connection-btn" class="quick-action-btn" style="width: 100%; margin-top: 8px; padding: 6px 12px; background: #333; color: white; border: 1px solid #555; border-radius: 4px; font-size: 11px; cursor: pointer;" data-i18n="testConnection"></button>
          </div>

          <!-- Connection Status -->
          <div id="debug-connection-status" style="margin-top: 12px; padding: 8px 12px; background: rgba(0, 0, 0, 0.3); border-radius: 4px; font-size: 11px; font-family: monospace;">
            <span style="color: #888;" data-i18n="disconnected"></span>
          </div>

        </div>

        <!-- Debug Info -->
        <div style="margin-top: 12px; padding: 12px; background: rgba(0, 0, 0, 0.2); border-radius: 6px; font-size: 11px; line-height: 1.6;">
          <p style="margin: 0; color: #888;">
            <strong style="color: var(--primary);" data-i18n="aboutDebugMode"></strong><br>
            <span data-i18n="aboutDebugModeDesc"></span><br><br>
            <strong data-i18n="debugFeatures"></strong><br>
            <span data-i18n="debugFeaturesList" data-i18n-html="true"></span><br><br>
            <strong data-i18n="debugServer"></strong> <span data-i18n="debugServerDesc" data-i18n-html="true"></span>
          </p>
        </div>
      </div>

      <div id="chat-message" class="message"></div>
    </div>

  </div>

  <script type="module" src="popup.js"></script>
</body>
</html>
